<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sign Up - AQI Updates</title>
  <style>
    /* Basic styling – adjust as needed */
    body { font-family: Arial, sans-serif; margin: 20px; }
    .form-group { margin-bottom: 15px; }
    .error { color: red; font-size: 0.9em; }
    .strength { font-weight: bold; }
    .toggle-password { cursor: pointer; margin-left: 5px; }
  </style>
</head>
<body>
  <h2>Sign Up</h2>
  <form id="signupForm" action="/api/signup" method="post">
    <div class="form-group">
      <label for="email">Email:</label><br/>
      <input type="email" id="email" name="email" required />
    </div>
    <div class="form-group">
      <label for="password">Password:</label><br/>
      <input type="password" id="password" name="password" required />
      <span class="toggle-password" data-target="password">&#128521;</span>
      <div id="passwordStrength" class="strength"></div>
    </div>
    <div class="form-group">
      <label for="password2">Confirm Password:</label><br/>
      <input type="password" id="password2" name="password2" required />
      <span class="toggle-password" data-target="password2">&#128521;</span>
      <div id="passwordMatch" class="error"></div>
    </div>
    <!-- Other fields, e.g. address and policy checkboxes -->
    <div class="form-group">
      <label for="address">Address:</label><br/>
      <input type="text" id="address" name="address" required />
    </div>
    <div class="form-group">
      <input type="checkbox" id="agreePolicy" name="agreePolicy" required />
      <label for="agreePolicy">I agree to the policy</label>
    </div>
    <div class="form-group">
      <input type="checkbox" id="agreeTerms" name="agreeTerms" required />
      <label for="agreeTerms">I agree to the terms</label>
    </div>
    <button type="submit">Sign Up</button>
  </form>

  <script>
    // Password strength and matching
    const passwordInput = document.getElementById('password');
    const password2Input = document.getElementById('password2');
    const strengthDiv = document.getElementById('passwordStrength');
    const matchDiv = document.getElementById('passwordMatch');

    function evaluateStrength(password) {
      // A simple evaluation – you may replace this with a more robust library like zxcvbn
      if (password.length < 8) return { text: 'Too Short', color: 'red' };
      let score = 0;
      if (/[a-z]/.test(password)) score++;
      if (/[A-Z]/.test(password)) score++;
      if (/[0-9]/.test(password)) score++;
      if (/[^A-Za-z0-9]/.test(password)) score++;
      if (password.length > 12) score++;
      if (score <= 2) return { text: 'Weak', color: 'orange' };
      else if (score === 3 || score === 4) return { text: 'Medium', color: 'blue' };
      else return { text: 'Strong', color: 'green' };
    }

    passwordInput.addEventListener('input', function() {
      const result = evaluateStrength(passwordInput.value);
      strengthDiv.textContent = result.text;
      strengthDiv.style.color = result.color;
    });

    function checkPasswordMatch() {
      if (passwordInput.value !== password2Input.value) {
        matchDiv.textContent = "Passwords do not match";
      } else {
        matchDiv.textContent = "";
      }
    }

    passwordInput.addEventListener('input', checkPasswordMatch);
    password2Input.addEventListener('input', checkPasswordMatch);

    // Toggle password visibility using the winky icon
    document.querySelectorAll('.toggle-password').forEach(function(el) {
      el.addEventListener('click', function() {
        const targetId = el.getAttribute('data-target');
        const input = document.getElementById(targetId);
        if (input.type === "password") {
          input.type = "text";
          el.style.opacity = 0.5;
        } else {
          input.type = "password";
          el.style.opacity = 1;
        }
      });
    });

    // Prevent form submission if passwords don't match
    document.getElementById('signupForm').addEventListener('submit', function(e) {
      if (passwordInput.value !== password2Input.value) {
        e.preventDefault();
        alert("Passwords do not match!");
      }
    });
  </script>
</body>
</html>
